<div class="flex flex-col w-full p-4 bg-card dark:bg-default">
    <div class="flex items-center justify-between mb-4">
        <h2 class="truncate text-3xl font-extrabold leading-7 tracking-tight sm:leading-10 md:text-4xl">Usuarios</h2>
        <button class="px-3 py-1.5 rounded bg-primary-600 text-white hover:bg-primary-700">
            Agregar Usuario
        </button>
    </div>

    <div *ngIf="loading" class="p-6 text-center text-primary">Cargando...</div>

    <ng-container *ngIf="!loading">
        <div class="overflow-x-auto border rounded">
        <table class="min-w-full divide-y">
            <thead class="">
            <tr>
            <th class="px-4 py-3 text-left font-medium text-primary uppercase tracking-wider">#</th>
            <th class="px-4 py-3 text-left font-medium text-primary uppercase tracking-wider">Usuario</th>
            <th class="px-4 py-3 text-left font-medium text-primary uppercase tracking-wider">Correo</th>
            <th class="px-4 py-3 text-left font-medium text-primary uppercase tracking-wider">Estado</th>
            <th class="px-4 py-3 text-left font-medium text-primary uppercase tracking-wider">Rol actual</th>
            <th class="px-4 py-3 text-left font-medium text-primary uppercase tracking-wider">Acciones</th>
            </tr>
            </thead>
            <tbody class="bg-card dark:bg-default divide-y">
            <tr *ngFor="let u of usuarios; let i = index" class="hover:bg-gray-50 dark:hover:bg-slate-600">
            <td class="px-4 py-2">{{ i + 1 }}</td>
            <td class="px-4 py-2">{{ u.nombreUsuario }}</td>
            <td class="px-4 py-2">{{ u.correoElectronico }}</td>
            <td class="px-4 py-2">
                <span class="px-2 py-0.5 rounded-full font-medium"
                    [ngClass]="{
                        'bg-green-100 text-green-800': (u?.estado?.tipoEstado?.toLowerCase?.() || '') === 'activo',
                        'bg-red-100 text-red-800': (u?.estado?.tipoEstado?.toLowerCase?.() || '') === 'inactivo',
                        'bg-gray-100 text-gray-800': ['activo','inactivo'].indexOf((u?.estado?.tipoEstado?.toLowerCase?.() || '')) === -1
                    }">
                {{ u?.estado?.nombre || '—' }}
                </span>
            </td>
            <td class="px-4 py-2">
                <span class="px-2 py-0.5 rounded-full font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100">
                {{ (u?.rol?.nombreRol || '—') | titlecase}}
                </span>
            </td>
            <td class="px-4 py-2">
                <button class="px-2 py-1 rounded bg-primary-600 text-white hover:bg-primary-700"
                        (click)="editarRolUsuario(u)">
                Editar rol
                </button>
            </td>
            </tr>
            </tbody>
        </table>
        </div>

        <div *ngIf="!usuarios.length" class="p-6 text-center text-primary">
        No hay usuarios para mostrar.
        </div>
    </ng-container>
</div>
